C51 COMPILER V9.60.7.0   I2C                                                               10/24/2023 16:02:05 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE I2C
OBJECT MODULE PLACED IN .\Objects\I2C.obj
COMPILER INVOKED BY: E:\keil1\C51\BIN\C51.EXE APP\I2C.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\APP;.\USER) DEBUG OBJECTEXTEND
                    - PRINT(.\Listings\I2C.lst) TABS(2) OBJECT(.\Objects\I2C.obj)

line level    source

   1          //#include "AllHead.h"
   2          
   3          //#define I2C_Delay() {_nop_();_nop_();_nop_();_nop_();} //ºê¶¨ÒåÑÓÊ±º¯Êý(Ò»¸ö_nop_()µÄÊ±¼ä¾ÍÊÇÒ»¸ö»úÆ÷ÖÜÆ
             -Ú)
   4          
   5          ///* ²úÉú×ÜÏßÆðÊ¼ÐÅºÅ */
   6          //void I2C_Start()
   7          //{
   8          //  I2C_SCL = 1;  //Ê×ÏÈÈ·±£ SDA¡¢SCL ¶¼ÊÇ¸ßµçÆ½
   9          //  I2C_SDA = 1;
  10          //  I2C_Delay();
  11          //  I2C_SDA = 0;  //µ±SCLÎª¸ßµçÆ½Ê±£¬SDAÓÉ¸ß±äÎªµÍ
  12          //  I2C_Delay();
  13          //  I2C_SCL = 0;  //Ç¯×¡I2C×ÜÏß£¬×¼±¸·¢ËÍ»ò½ÓÊÕÊý¾Ý(SCLÎªµÍµçÆ½Ê±Êý¾Ý¿ÉÒÔ¸Ä±ä)
  14          //}
  15          
  16          ///* ²úÉú×ÜÏßÍ£Ö¹ÐÅºÅ */
  17          //void I2C_Stop()
  18          //{
  19          //  I2C_SCL = 0;  //Ê×ÏÈÈ·±£ SDA¡¢SCL ¶¼ÊÇµÍµçÆ½
  20          //  I2C_SDA = 0;
  21          //  I2C_Delay();
  22          //  I2C_SCL = 1;  //ÏÈÀ­¸ß SCL
  23          //  I2C_Delay();
  24          //  I2C_SDA = 1;  //µ±SCLÎª¸ßµçÆ½Ê±£¬SDAÓÉµÍ±äÎª¸ß
  25          //  I2C_Delay();
  26          //}
  27          
  28          ///* I2C ×ÜÏßÐ´²Ù×÷£¬dat-´ýÐ´Èë×Ö½Ú£¬·µ»ØÖµ-´Ó»úÓ¦´ðÎ»µÄÖµ */
  29          //bit I2C_Write(u8 dat)
  30          //{
  31          //  bit ack; //ÓÃÓÚÔÝ´æÓ¦´ðÎ»µÄÖµ
  32          //  u8 i;
  33          //  for(i = 0;i < 8; i++)
  34          //  {
  35          //    if((dat & 0x80) > 0) //±È½Ï×î¸ßÎ» (Èç1011 0100 & 1000 0000 --> 1000 0000 ×î¸ßÎ»µÈÓÚ1 ´óÓÚ0)
  36          //      I2C_SDA = 1;
  37          //    else
  38          //      I2C_SDA = 0;
  39          //    dat <<= 1;           //×óÒÆÒ»Î»(½«´Î¸ßÎ»ÒÆµ½×î¸ßÎ»)
  40          //    I2C_Delay();
  41          //    I2C_SCL = 1;         //Îª1Êý¾ÝÎÈ¶¨µÈ´ýÏÂÒ»´Î´«Êä
  42          //    I2C_Delay();
  43          //    I2C_SCL = 0;         //Êý¾Ý´«ÊäÍê±Ï£¬ÈÃSCLÎª0£¬Ê¹ÏÂÒ»´ÎÊý¾Ý¿ÉÒÔ¸Ä±ä²¢½øÐÐ´«Êä
  44          //  }
  45          //  I2C_SDA = 1;     //8 Î»Êý¾Ý·¢ËÍÍêºó£¬Ö÷»úÊÍ·Å SDA£¬ÒÔ¼ì²â´Ó»úÓ¦´ð
  46          //  I2C_Delay();
  47          //  I2C_SCL = 1;     //À­¸ß SCL
  48          //  ack = I2C_SDA;   //¶ÁÈ¡´ËÊ±µÄ SDA Öµ£¬¼´Îª´Ó»úµÄÓ¦´ðÖµ
  49          //  I2C_Delay();
  50          //  I2C_SCL = 0;     //ÔÙÀ­µÍ SCL Íê³ÉÓ¦´ðÎ»£¬²¢±£³Ö×¡×ÜÏß
  51          //  return (~ack);   //Ó¦´ðÖµÈ¡·´ÒÔ·ûºÏÍ¨³£µÄÂß¼­£º
  52          //}                  //0=²»´æÔÚ»òÃ¦»òÐ´ÈëÊ§°Ü£¬1=´æÔÚÇÒ¿ÕÏÐ»òÐ´Èë³É¹¦
  53          
C51 COMPILER V9.60.7.0   I2C                                                               10/24/2023 16:02:05 PAGE 2   

  54          ///* I2C ×ÜÏß¶Á²Ù×÷£¬²¢·¢ËÍ·ÇÓ¦´ðÐÅºÅ£¬·µ»ØÖµ-¶Áµ½µÄ×Ö½Ú */
  55          //u8 I2C_ReadNACK()
  56          //{
  57          //  u8 receive = 0;         //±£´æ¶ÁÈ¡µÄÊý¾Ý
  58          //  u8 i;
  59          //  I2C_SDA = 1;            //Ê×ÏÈÈ·±£Ö÷»úÊÍ·Å SDA
  60          //  for(i = 0; i < 8; i++)
  61          //  {
  62          //    I2C_SCL = 0;
  63          //    I2C_Delay();
  64          //    I2C_SCL = 1;      //SCLÎª1Ê±Êý¾ÝÎÈ¶¨£¬¿ÉÒÔ´«ÊäÊý¾Ý
  65          //    receive <<= 1;    //½«½ÓÊÕµ½µÄÊý¾ÝÏò×óÒÆ¶¯Ò»Î»    (¼ÙÉèÒª´«Êä 1001 1000£¬ÔòÏÈ½ÓÊÕµ½¸ßÎ»1£¬ÔòSDAÎª1£¬
  66          //    if(1 == I2C_SDA)  //Èç¹ûSDAÎª1                    receive¼Ó1£¬ÔòreceiveÎª 0000 0001£¬Ö®ºó½«receive
  67          //      receive++;      //Ôò½ÓÊÕµ½µÄÊý¾Ý¼Ó1             Ïò×óÒÆ¶¯Ò»Î»£¬ÔòreceiveÎª 0000 0010,½Ó×Å´«ÊäµÚ¶þÎ»0£¬
  68          //    I2C_Delay();                                   //ÔòSDAÎª0£¬²»½øÈëifÓï¾ä£¬receive½ÓÊÕµ½0£¬Ôòreceive
  69          //    I2C_SCL = 0;//ÔÙÀ­µÍ SCL£¬ÒÔÊ¹´Ó»ú·¢ËÍ³öÏÂÒ»Î»    Îª 0000 0010£¬Ö®ºó½«receiveÏò×óÒÆ¶¯Ò»Î»£¬ÔòreceiveÎª
  70          //  }                                                //0000 0100 ÒÔ´ËÀàÍÆ½ÓÊÕÊý¾Ý£¬Ö±µ½Êý¾Ý´«ÊäÍê³ÉÔòÌø³öÑ­
             -»·)
  71          //  I2C_SDA = 1;   //8 Î»Êý¾Ý·¢ËÍÍêºó£¬À­¸ß SDA£¬·¢ËÍ·ÇÓ¦´ðÐÅºÅ
  72          //  I2C_Delay();
  73          //  I2C_SCL = 1;   //À­¸ß SCL
  74          //  I2C_Delay();
  75          //  I2C_SCL = 0;   //ÔÙÀ­µÍ SCL Íê³É·ÇÓ¦´ðÎ»£¬²¢±£³Ö×¡×ÜÏß
  76          //  
  77          //  return receive;
  78          //}
  79          
  80          ///* I2C ×ÜÏß¶Á²Ù×÷£¬²¢·¢ËÍÓ¦´ðÐÅºÅ£¬·µ»ØÖµ-¶Áµ½µÄ×Ö½Ú */
  81          //u8 I2C_ReadACK()
  82          //{
  83          //  u8 receive = 0;         //±£´æ¶ÁÈ¡µÄÊý¾Ý
  84          //  u8 i;
  85          //  I2C_SDA = 1;            //Ê×ÏÈÈ·±£Ö÷»úÊÍ·Å SDA
  86          //  for(i = 0; i < 8; i++)
  87          //  {
  88          //    I2C_SCL = 0;
  89          //    I2C_Delay();
  90          //    I2C_SCL = 1;      //SCLÎª1Ê±Êý¾ÝÎÈ¶¨£¬¿ÉÒÔ´«ÊäÊý¾Ý
  91          //    receive <<= 1;    //½«½ÓÊÕµ½µÄÊý¾ÝÏò×óÒÆ¶¯Ò»Î»  (¼ÙÉèÒª´«Êä 1001 1000£¬ÔòÏÈ½ÓÊÕµ½¸ßÎ»1£¬ÔòSDAÎª1£¬
  92          //    if(1 == I2C_SDA)  //Èç¹ûSDAÎª1                  receive¼Ó1£¬ÔòreceiveÎª 0000 0001£¬Ö®ºó½«receive
  93          //      receive++;      //Ôò½ÓÊÕµ½µÄÊý¾Ý¼Ó1           Ïò×óÒÆ¶¯Ò»Î»£¬ÔòreceiveÎª 0000 0010,½Ó×Å´«ÊäµÚ¶þÎ»0£¬
  94          //    I2C_Delay();                                 //ÔòSDAÎª0£¬²»½øÈëifÓï¾ä£¬receive½ÓÊÕµ½0£¬Ôòreceive
  95          //    I2C_SCL = 0;                                 //Îª 0000 0010£¬Ö®ºó½«receiveÏò×óÒÆ¶¯Ò»Î»£¬ÔòreceiveÎª
  96          //  }                                              //0000 0100 ÒÔ´ËÀàÍÆ½ÓÊÕÊý¾Ý£¬Ö±µ½Êý¾Ý´«ÊäÍê³ÉÔòÌø³öÑ­»·
             -)
  97          //  I2C_SDA = 0;  //8 Î»Êý¾Ý·¢ËÍÍêºó£¬À­µÍ SDA£¬·¢ËÍÓ¦´ðÐÅºÅ
  98          //  I2C_Delay();
  99          //  I2C_SCL = 1;  //À­¸ß SCL
 100          //  I2C_Delay();
 101          //  I2C_SCL = 0;  //ÔÙÀ­µÍ SCL Íê³ÉÓ¦´ðÎ»£¬²¢±£³Ö×¡×ÜÏß
 102          //  
 103          //  return receive;
 104          //}


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   ----    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.60.7.0   I2C                                                               10/24/2023 16:02:05 PAGE 3   

   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
